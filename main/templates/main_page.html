{% extends 'base.html' %}
{% block title %}Main Page{% endblock %}
{% block content %}
<h2 class="mb-4">Recent Posts</h2>
<a href="{% url 'post_cr' %}" class="btn btn-primary btn-lg rounded-pill shadow">
    âž• Add Post
</a>
<br><br>
{% for post in posts %}
<div class="card mb-3">
    <div class="card-body">
        <h5 class="card-title text-primary">
            <a href="{% url 'other_profile' post.creator.id %}" class="text-decoration-none">
                {{ post.creator.username }}
            </a>
        </h5>
        <h6 class="card-subtitle mb-2 text-muted small">{{ post.creation_time }}</h6>
        <p class="card-text">{{ post.content }}</p>
        <div class="d-flex align-items-center gap-2">
            {% if user.is_authenticated %}
            <form action="{% url 'like_post' post.id %}" method="POST" style="display:inline;">
                {% csrf_token %}
                {% if user in post.likes.all %}
                <button type="submit" class="btn btn-sm btn-outline-danger">Unlike</button>
                {% else %}
                <button type="submit" class="btn btn-sm btn-outline-success">Like</button>
                {% endif %}
            </form>
            {% else %}
            <button type="button" class="btn btn-sm btn-outline-secondary"
                onclick="alert('Please register or log in to interact with posts')">
                Like
            </button>
            {% endif %}
            <a href="{% url 'comment_section' post.id %}" class="btn btn-sm btn-outline-secondary">
                View Comments
            </a>
            <span>{{ post.total_likes }} likes</span>
        </div>
    </div>
</div>
{% endfor %}
{% endblock %}